{
    "00401fea": {
        "rules": [
            "encrypt data using RC4 KSA/d551e75340ca4df5873c54628ec75636"
        ],
        "decompiled_code": "\nulong __cdecl fcn.00401fea(int32_t arg_8h, int32_t arg_ch)\n\n{\n    char cVar1;\n    uint in_EAX;\n    int32_t iVar2;\n    uint32_t uVar3;\n    uint8_t uVar4;\n    uint32_t uVar5;\n    uint in_EDX;\n    uint32_t uVar6;\n    \n    iVar2 = -0x10204;\n    uVar5 = 0x40;\n    do {\n        *(uVar5 * 4 + 0x40273a) = iVar2;\n        iVar2 = iVar2 + -0x4040404;\n        uVar5 = uVar5 - 1;\n    } while (uVar5 != 0);\n    uVar3 = 0;\n    do {\n        uVar6 = 0;\n        iVar2 = arg_ch;\n        do {\n            cVar1 = *(uVar5 + 0x40273e);\n            uVar3 = uVar3 + *(uVar6 + arg_8h) + cVar1;\n            *(uVar5 + 0x40273e) = *(uVar3 + 0x40273e);\n            *(uVar3 + 0x40273e) = cVar1;\n            uVar4 = uVar5 + 1;\n            uVar5 = uVar5 & 0xffffff00 | uVar4;\n            if (uVar4 == 0) {\n                return CONCAT44(in_EDX, in_EAX);\n            }\n            uVar6 = uVar6 + 1;\n            iVar2 = iVar2 + -1;\n        } while (iVar2 != 0);\n    } while( true );\n}\n",
        "token_count": 371
    },
    "null": {
        "rules": [
            "validate payment card number using luhn algorithm with no lookup table/ca2c8d7b7d994625afebb42274522c55"
        ],
        "decompiled_code": "\n// WARNING: Unable to track spacebase fully for stack\n// WARNING: Removing unreachable block (ram,0x004013ee)\n\nuint64_t main(int32_t param_1)\n\n{\n    char cVar1;\n    int32_t iVar2;\n    code *pcVar3;\n    code *pcVar4;\n    uint32_t uVar5;\n    uint8_t uVar7;\n    int32_t *extraout_ECX;\n    uint32_t extraout_ECX_00;\n    uint32_t *puVar6;\n    uchar uVar8;\n    uint8_t uVar12;\n    int32_t iVar9;\n    uint32_t uVar10;\n    uint32_t uVar11;\n    uint8_t uVar14;\n    uint unaff_EBX;\n    uint32_t uVar13;\n    code *pcVar15;\n    uint32_t uVar16;\n    uint32_t uVar17;\n    char *pcVar18;\n    int32_t *piVar19;\n    int32_t in_FS_OFFSET;\n    uint8_t uVar20;\n    uint64_t uVar21;\n    uint uStackY616;\n    uint uStackY612;\n    uint uStackY608;\n    uint uStackY604;\n    uint uStackY600;\n    uint uStackY596;\n    uint uStackY592;\n    uint uStackY588;\n    uint uStackY584;\n    uint uStackY580;\n    uint uStackY576;\n    int32_t iStackY572;\n    int32_t iStackY568;\n    uint uStackY564;\n    uint uStackY560;\n    uint uStackY556;\n    uint uStackY552;\n    int32_t iStackY548;\n    uint uStackY544;\n    uint uStackY540;\n    int32_t iStackY536;\n    uint uStackY532;\n    int32_t aiStack52 [2];\n    char acStack29 [9];\n    int32_t iStack20;\n    code *apcStack16 [2];\n    int32_t iStack8;\n    \n    // [00] -r-x section size 8192 named .text\n    aiStack52[1] = 0x10101;\n    uVar14 = unaff_EBX >> 8;\n    *0x101a8 = param_1 + 0x403006 + CARRY1(uVar14, uVar14);\n    aiStack52[0] = 0;\n    *0x4040ac = (*_sym.imp.USER32.dll_CreateDialogParamA)();\n    (*_sym.imp.USER32.dll_LoadIconA)();\n    pcVar4 = _sym.imp.USER32.dll_SendMessageA;\n    (*_sym.imp.USER32.dll_SendMessageA)();\n    pcVar15 = _sym.imp.USER32.dll_GetSystemMenu;\n    (*_sym.imp.USER32.dll_GetSystemMenu)();\n    pcVar3 = _sym.imp.USER32.dll_AppendMenuA;\n    iVar2 = (*_sym.imp.USER32.dll_AppendMenuA)();\n    *extraout_ECX = *extraout_ECX + iVar2;\n    (*pcVar3)();\n    *0x4040b0 = sym.imp.USER32.dll_GetDlgItem + CARRY4(pcVar15, pcVar15) + *0x4040ac;\n    *0x4040a0 = (*_sym.imp.USER32.dll_SetWindowLongA)();\n    (*pcVar4)();\n    (*pcVar4)();\n    iVar2 = -0x4d2fa201;\n    do {\n        iVar2 = iVar2 + -1;\n    } while (iVar2 != 0);\n    pe_dos_header = pe_dos_header + ****(*(*(in_FS_OFFSET + 0x30) + 0xc) + 0xc);\n    acStack29[pcVar4] = 'G';\n    (acStack29 + 1)[pcVar4] = 'P';\n    (acStack29 + 2)[pcVar4] = 'A';\n    *(apcStack16 + pcVar4) = 0;\n    iVar2 = *(*(&iStack8 + pcVar4) + 0x3c) + *(&iStack8 + pcVar4);\n    *(aiStack52 + pcVar4) = *(iVar2 + 0x78);\n    *(pcVar4 + aiStack52 + 1) = *(iVar2 + 0x7c);\n    iVar2 = *(&iStack8 + pcVar4) + *(aiStack52 + pcVar4);\n    pcVar15 = *(iVar2 + 0x18);\n    iVar9 = 0;\n    while (((pcVar18 = *(*(iVar2 + 0x20) + *(&iStack8 + pcVar4) + iVar9 * 4 + 0xc) + *(&iStack8 + pcVar4), \n            *pcVar18 != acStack29[pcVar4] || (pcVar18[3] != (acStack29 + 1)[pcVar4])) ||\n           (pcVar18[7] != (acStack29 + 2)[pcVar4]))) {\n        iVar9 = iVar9 + 1;\n        pcVar15 = pcVar15 + -1;\n        if (pcVar15 == NULL) {\ncode_r0x004013ff:\n            pcVar3 = (*pcVar15)();\n            (*pcVar3)();\n            *0x404200 = 0x10007;\n            fcn.00401fea(0x40223a, 0x14);\n            fcn.004020d7(0x401d9a, 0x15a);\n            pcVar3 = (*pcVar15)();\n            (*pcVar3)();\n            *0x40412c = (*pcVar15)();\n            pcVar3 = (*pcVar15)();\n            (*pcVar3)();\n            pcVar3 = (*pcVar15)();\n            (*pcVar3)();\n            pcVar3 = (*pcVar15)();\n            (*pcVar3)();\n            (**0x40412c)();\n            *0x404122 = pcVar15;\n            pcVar3 = (*pcVar15)();\n            (*pcVar3)();\n            pcVar3 = (*pcVar15)();\n            *0x403fe4 = (*pcVar3)();\n            pcVar3 = (**0x404122)();\n            (*pcVar3)();\n            pcVar3 = (**0x404122)();\n            (*pcVar3)();\n            fcn.00401fea(0x40223a, 0x14);\n            pcVar3 = (*pcVar15)();\n            (*pcVar3)();\n            pcVar3 = (*pcVar15)();\n            (*pcVar3)();\n            pcVar3 = (*pcVar15)();\n            *0x401fbf = (*pcVar3)();\n            pcVar3 = (*pcVar15)();\n            *0x401fc3 = (*pcVar3)();\n            pcVar15 = (*pcVar15)();\n            (*pcVar15)();\n            pcVar15 = (**0x404122)();\n            iVar2 = *0x401fc3;\n            (*pcVar15)();\n            uStackY532 = 0x40199e;\n            iStackY536 = *0x401fc3;\n            fcn.004020d7(*0x401fc3, iVar2);\n            iStackY548 = *0x401fc3;\n            iVar2 = *0x401fc3 + *(*0x401fc3 + 0x3c);\n            uStackY552 = *(iVar2 + 0x34);\n            uStackY532 = 0x401da9;\n            uStackY540 = 0x4019f7;\n            *0x403fdc = (**0x404122)();\n            uStackY540 = 0;\n            uStackY544 = *(iVar2 + 0x54);\n            uStackY556 = *0x401f2a;\n            uStackY560 = 0x401a40;\n            (**0x403fdc)();\n            *(&iStack20 + pcVar4) = iVar2 + 0x18;\n            *(&iStack20 + pcVar4) = *(&iStack20 + pcVar4) + *(iVar2 + 0x14);\n            for (uVar16 = 0; uVar16 < *(iVar2 + 6); uVar16 = uVar16 + 1) {\n                iVar9 = uVar16 * 0x28 + *(&iStack20 + pcVar4);\n                iStackY572 = *(iVar9 + 0xc) + 0x400000;\n                iStackY568 = *0x401fc3 + *(iVar9 + 0x14);\n                uStackY560 = 0;\n                uStackY564 = *(iVar9 + 0x10);\n                uStackY576 = *0x401f2a;\n                uStackY580 = 0x401b12;\n                (**0x403fdc)();\n            }\n            *0x404340 = *(iVar2 + 0x34);\n            iStackY572 = *0x4042a4 + 8;\n            uStackY560 = 0;\n            uStackY564 = 4;\n            iStackY568 = 0x404340;\n            uStackY576 = *0x401f2a;\n            uStackY580 = 0x401b9f;\n            (**0x403fdc)();\n            uVar20 = 0xffbfffff < *(iVar2 + 0x28);\n            uVar13 = *(iVar2 + 0x28) + 0x400000;\n            uStackY580 = 0x401e1d;\n            uStackY584 = uStackY576;\n            uStackY588 = 0x401bd8;\n            *0x4042b0 = uVar13;\n            pcVar4 = (**0x404122)();\n            uStackY588 = 0x404200;\n            uStackY592 = *0x401f2e;\n            uStackY596 = 0x401bf8;\n            (*pcVar4)();\n            uStackY596 = 0x401dbc;\n            uStackY600 = *0x403fe4;\n            uStackY604 = 0x401c1c;\n            pcVar4 = (**0x404122)();\n            uStackY604 = *0x401f2a;\n            uStackY608 = 0x401c30;\n            (*pcVar4)();\n            uStackY608 = 0x401e41;\n            uStackY612 = uStackY604;\n            uStackY616 = 0x401c46;\n            pcVar4 = (**0x404122)();\n            uStackY616 = 0;\n            uVar21 = (*pcVar4)();\n            uVar14 = uVar21 >> 8;\n            uVar8 = uVar21 >> 0x20;\n            uVar11 = CONCAT11((uVar21 >> 0x28) - uVar14, uVar8);\n            cVar1 = extraout_ECX_00 | uVar16;\n            uVar5 = CONCAT11(uVar14, cVar1);\n            uVar10 = (extraout_ECX_00 | uVar16) & 0xffff0000 | uVar5;\n            iVar9 = ((CONCAT11((uVar11 >> 8) + uVar14 * '\\x02' | uVar14, uVar8) ^ uVar16) + 0x20b40c & 0x5d30) + 0x3b;\n            uVar13 = ((uVar13 & 0xffff0000 | CONCAT11(uVar13 >> 8 & extraout_ECX_00 >> 8, uVar13)) - uVar16) + 0x375e4;\n            uVar13 = ((uVar13 & 0xffff0000 | CONCAT11((uVar13 >> 8) * '\\x02', uVar13)) ^ &uStackY616) - 0x34b;\n            uVar17 = (uVar16 + uVar10 ^ 0x60f34a) - 0x5f;\n            uVar5 = (uVar21 & 0xffff0000ffff0000 | CONCAT11(uVar14 ^ uVar5 >> 8, uVar21)) &\n                    ((iVar2 - uVar16) - uVar20 & 0x6ec81 ^ ((uVar21 & 0xffff0000ffff0000) >> 0x20 | uVar11)) - uVar10;\n            uVar11 = CONCAT11((uVar13 >> 8) * '\\x02', uVar13);\n            uVar14 = uVar5 >> 8;\n            uVar16 = CONCAT11((iVar9 >> 8) + uVar14, iVar9);\n            cVar1 = cVar1 - uVar13;\n            uVar10 = uVar16 + 0x3832;\n            puVar6 = CONCAT11(-(uVar11 >> 8) - (0xffffc79f < uVar16 - 0x2e), cVar1) & 0xff75;\n            uVar16 = *puVar6;\n            *puVar6 = *puVar6 + 0x639001;\n            uVar13 = ((uVar13 & 0xffff0000 | uVar11) ^ uVar17 & 0x13ad92) - (0xff9c6ffe < uVar16);\n            uVar12 = uVar13 >> 8;\n            uVar16 = CONCAT11(uVar14 ^ uVar12, uVar5);\n            uVar14 = uVar16 >> 8;\n            uVar20 = puVar6 >> 8;\n            uVar7 = uVar20 + uVar14;\n            uVar13 = ((uVar13 & 0xffff0000 | CONCAT11(uVar12 + uVar14, uVar13)) - 0x8b98) - CARRY1(uVar20, uVar14);\n            uVar14 = (uVar13 >> 8) - uVar14;\n            uVar16 = (uVar5 & 0xffff0000 | uVar16) - uVar10;\n            uVar12 = uVar10 >> 8 | uVar7;\n            uVar20 = uVar16 >> 8;\n            uVar5 = uVar13 & 0xffff0000 | CONCAT11((uVar14 - uVar20) - (uVar12 < uVar14), uVar13);\n            uVar13 = ((uVar10 & 0xffff0000 | CONCAT11(uVar12 - uVar14, uVar10)) - 0xb29d) -\n                     (uVar14 < uVar20 || uVar14 - uVar20 < (uVar12 < uVar14));\n            uVar16 = uVar16 & 0xffff00ff;\n            uVar11 = ((uVar13 & 0xffff0000 | CONCAT11((uVar13 >> 8) + uVar20, uVar13)) & 0xbe1f0) + 0x2e;\n            uVar13 = uVar16 + uVar11;\n            uVar14 = uVar13 >> 8;\n            uVar20 = (CONCAT11(uVar7 * '\\x02', cVar1) & 0xff75) - uVar5 >> 8 ^ uVar11 >> 8 | uVar14 |\n                     ((uVar10 ^ 0xffff5c02) - uVar11) - CARRY4(uVar16, uVar11) >> 8;\n            iVar9 = ((uVar11 - (uVar5 - 0x298)) + -0x9a66) - (uVar14 < uVar20);\n            iVar2 = (uVar13 & 0xffff0000 | CONCAT11(uVar14 - uVar20, uVar13)) - 0x15f75e;\n            uVar11 = uVar17 & 0x130c02 ^ 0x9a66;\n            uVar13 = iVar9 + 0x17c3;\n            uVar14 = iVar2 >> 8;\n            uVar16 = CONCAT11((uVar13 >> 8) - uVar14, uVar13);\n            piVar19 = (0x37e - uVar11) - (iVar9 + 0x1912U < 0x14f) & 0x6ec81 ^ (uVar13 & 0xffff0000 | uVar16);\n            *piVar19 = *piVar19 + 0x46c3589;\n            return CONCAT44(((CONCAT11((uVar16 >> 8) + uVar14 * '\\x02' | uVar14, uVar13) ^ uVar11) + 0x20b40c & 0x5d30)\n                            + 0x3b, iVar2) & 0xffffffffffff00ff;\n        }\n    }\n    pcVar15 = *(*(iVar2 + 0x1c) + *(&iStack8 + pcVar4) + (*(*(iVar2 + 0x24) + *(&iStack8 + pcVar4) + iVar9 * 2) + 3) * 4\n               ) + *(&iStack8 + pcVar4);\n    *(apcStack16 + pcVar4) = pcVar15;\n    goto code_r0x004013ff;\n}\n",
        "token_count": 3779
    },
    "004020d7": {
        "rules": [
            "validate payment card number using luhn algorithm with no lookup table/ca2c8d7b7d994625afebb42274522c55"
        ],
        "decompiled_code": "\nulong __cdecl fcn.004020d7(uint8_t *arg_8h, int32_t arg_ch)\n\n{\n    char cVar1;\n    char cVar2;\n    uint in_EAX;\n    uint32_t uVar3;\n    uint in_EDX;\n    uint32_t uVar4;\n    \n    uVar3 = 0;\n    uVar4 = 0;\n    do {\n        uVar4 = uVar4 + 1;\n        cVar1 = *(uVar4 + 0x40273e);\n        uVar3 = uVar3 + cVar1;\n        cVar2 = *(uVar3 + 0x40273e);\n        *(uVar4 + 0x40273e) = cVar2;\n        *(uVar3 + 0x40273e) = cVar1;\n        *arg_8h = *arg_8h ^ *((cVar2 + cVar1) + 0x40273e);\n        arg_8h = arg_8h + 1;\n        arg_ch = arg_ch + -1;\n    } while (arg_ch != 0);\n    return CONCAT44(in_EDX, in_EAX);\n}\n",
        "token_count": 259
    },
    "00402290": {
        "rules": [
            "validate payment card number using luhn algorithm with no lookup table/ca2c8d7b7d994625afebb42274522c55",
            "enumerate PE sections/e92b906b5db4485ea433dde72854611a"
        ],
        "decompiled_code": "\n// WARNING: Unable to track spacebase fully for stack\n\ncode * __fastcall fcn.00402290(int32_t *param_1)\n\n{\n    uint8_t *puVar1;\n    uint8_t uVar2;\n    int32_t iVar3;\n    code *pcVar4;\n    int32_t in_EAX;\n    int32_t iVar5;\n    int32_t *piVar6;\n    uint8_t uVar7;\n    uchar *puVar8;\n    uchar *puVar9;\n    uchar *puVar10;\n    uint32_t unaff_EBP;\n    int32_t aiStack8 [2];\n    \n    *(unaff_EBP + 0x56002444) = *(unaff_EBP + 0x56002444) + param_1 + CARRY4(*0x10, unaff_EBP);\n    iVar3 = *(&stack0x00000018 + unaff_EBP);\n    *param_1 = *param_1 + in_EAX;\n    *(&stack0xfffffffc + unaff_EBP) = iVar3;\n    puVar8 = &stack0xfffffff8 + unaff_EBP;\n    *(&stack0xfffffff8 + unaff_EBP) = 0x4022a5;\n    (*_sym.imp.USER32.dll_GetWindowRect)();\n    pcVar4 = *0x101306c;\n    *(puVar8 + -4) = 1;\n    *(puVar8 + -8) = *(puVar8 + 0x14);\n    *(puVar8 + -0xc) = *(puVar8 + 0x10);\n    *(puVar8 + -0x10) = 1;\n    puVar9 = puVar8 + -0x14;\n    *(puVar8 + -0x14) = 0x4022bb;\n    iVar5 = (**0x101306c)();\n    *(puVar9 + -4) = (iVar5 / 2 - *(puVar9 + 0x20)) + *(puVar9 + 0x18);\n    *(puVar9 + -8) = 0;\n    puVar10 = puVar9 + -0xc;\n    *(puVar9 + -0xc) = 0x4022d1;\n    (*pcVar4)();\n    piVar6 = (*(puVar10 + 0x20) - *(puVar10 + 0x18)) / 2;\n    iVar5 = *piVar6;\n    puVar1 = iVar3 + -1;\n    uVar2 = *puVar1;\n    uVar7 = *(puVar10 + 0x20) - *(puVar10 + 0x18) >> 0x1f;\n    *puVar1 = *puVar1 + uVar7;\n    return sym.imp.USER32.dll_MoveWindow + piVar6 + (CARRY1(uVar2, uVar7) - iVar5);\n}\n",
        "token_count": 637
    }
}