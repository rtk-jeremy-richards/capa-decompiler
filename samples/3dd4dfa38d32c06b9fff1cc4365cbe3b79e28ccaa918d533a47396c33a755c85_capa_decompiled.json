{
    "00401fea": {
        "rules": [
            "encrypt data using RC4 KSA/d551e75340ca4df5873c54628ec75636"
        ],
        "decompiled_code": "\nulong __cdecl fcn.00401fea(int32_t arg_8h, int32_t arg_ch)\n\n{\n    char cVar1;\n    uint in_EAX;\n    int32_t iVar2;\n    uint32_t uVar3;\n    uint8_t uVar4;\n    uint32_t uVar5;\n    uint in_EDX;\n    uint32_t uVar6;\n    \n    iVar2 = -0x10204;\n    uVar5 = 0x40;\n    do {\n        *(uVar5 * 4 + 0x40273a) = iVar2;\n        iVar2 = iVar2 + -0x4040404;\n        uVar5 = uVar5 - 1;\n    } while (uVar5 != 0);\n    uVar3 = 0;\n    do {\n        uVar6 = 0;\n        iVar2 = arg_ch;\n        do {\n            cVar1 = *(uVar5 + 0x40273e);\n            uVar3 = uVar3 + *(uVar6 + arg_8h) + cVar1;\n            *(uVar5 + 0x40273e) = *(uVar3 + 0x40273e);\n            *(uVar3 + 0x40273e) = cVar1;\n            uVar4 = uVar5 + 1;\n            uVar5 = uVar5 & 0xffffff00 | uVar4;\n            if (uVar4 == 0) {\n                return CONCAT44(in_EDX, in_EAX);\n            }\n            uVar6 = uVar6 + 1;\n            iVar2 = iVar2 + -1;\n        } while (iVar2 != 0);\n    } while( true );\n}\n",
        "token_count": 371
    },
    "null": {
        "rules": [
            "validate payment card number using luhn algorithm with no lookup table/ca2c8d7b7d994625afebb42274522c55"
        ],
        "decompiled_code": "\n// WARNING: Unable to track spacebase fully for stack\n// WARNING: Removing unreachable block (ram,0x004013ee)\n\nuint64_t __cdecl main(int32_t argv)\n\n{\n    uint16_t uVar1;\n    char cVar2;\n    code *pcVar3;\n    int32_t iVar4;\n    int32_t iVar5;\n    code *pcVar6;\n    uint32_t uVar7;\n    uint8_t uVar9;\n    int32_t *extraout_ECX;\n    uint32_t extraout_ECX_00;\n    uint32_t *puVar8;\n    uchar uVar10;\n    uint8_t uVar14;\n    int32_t iVar11;\n    uint32_t uVar12;\n    uint32_t uVar13;\n    uint8_t uVar16;\n    uint unaff_EBX;\n    uint32_t uVar15;\n    code *pcVar17;\n    uint32_t uVar18;\n    uint32_t uVar19;\n    char *pcVar20;\n    int32_t *piVar21;\n    int32_t in_FS_OFFSET;\n    uint8_t uVar22;\n    uint64_t uVar23;\n    uint uStackY616;\n    uint uStackY612;\n    uint uStackY608;\n    uint uStackY604;\n    uint uStackY600;\n    uint uStackY596;\n    uint uStackY592;\n    uint uStackY588;\n    uint uStackY584;\n    uint uStackY580;\n    uint uStackY576;\n    int32_t iStackY572;\n    int32_t iStackY568;\n    uint uStackY564;\n    uint uStackY560;\n    uint uStackY556;\n    uint uStackY552;\n    int32_t iStackY548;\n    uint uStackY544;\n    uint uStackY540;\n    int32_t iStackY536;\n    uint uStackY532;\n    uint var_30h;\n    uint var_2ch;\n    uint var_19h;\n    uint var_ch;\n    uint var_4h;\n    \n    uVar16 = unaff_EBX >> 8;\n    // [00] -r-x section size 8192 named .text\n    *0x101a8 = argv + 0x403006 + CARRY1(uVar16, uVar16);\n    *0x4040ac = (*_sym.imp.USER32.dll_CreateDialogParamA)();\n    (*_sym.imp.USER32.dll_LoadIconA)();\n    pcVar17 = _sym.imp.USER32.dll_SendMessageA;\n    (*_sym.imp.USER32.dll_SendMessageA)();\n    pcVar6 = _sym.imp.USER32.dll_GetSystemMenu;\n    (*_sym.imp.USER32.dll_GetSystemMenu)();\n    pcVar3 = _sym.imp.USER32.dll_AppendMenuA;\n    iVar4 = (*_sym.imp.USER32.dll_AppendMenuA)();\n    *extraout_ECX = *extraout_ECX + iVar4;\n    (*pcVar3)();\n    *0x4040b0 = sym.imp.USER32.dll_GetDlgItem + CARRY4(pcVar6, pcVar6) + *0x4040ac;\n    *0x4040a0 = (*_sym.imp.USER32.dll_SetWindowLongA)();\n    (*pcVar17)();\n    (*pcVar17)();\n    iVar4 = -0x4d2fa201;\n    do {\n        iVar4 = iVar4 + -1;\n    } while (iVar4 != 0);\n    iVar4 = *(***(*(*(in_FS_OFFSET + 0x30) + 0xc) + 0xc) + 0x18);\n    iVar5 = iVar4 + *(*(iVar4 + 0x3c) + iVar4 + 0x78);\n    pcVar17 = *(iVar5 + 0x18);\n    iVar11 = 0;\n    while (((pcVar20 = *(*(iVar5 + 0x20) + iVar4 + iVar11 * 4 + 0xc) + iVar4,  *pcVar20 != 'G' || (pcVar20[3] != 'P'))\n           || (pcVar20[7] != 'A'))) {\n        iVar11 = iVar11 + 1;\n        pcVar17 = pcVar17 + -1;\n        if (pcVar17 == NULL) {\ncode_r0x004013ff:\n            pcVar6 = (*pcVar17)();\n            (*pcVar6)();\n            *0x404200 = 0x10007;\n            fcn.00401fea(0x40223a, 0x14);\n            fcn.004020d7(0x401d9a, 0x15a);\n            pcVar6 = (*pcVar17)();\n            (*pcVar6)();\n            *0x40412c = (*pcVar17)();\n            pcVar6 = (*pcVar17)();\n            (*pcVar6)();\n            pcVar6 = (*pcVar17)();\n            (*pcVar6)();\n            pcVar6 = (*pcVar17)();\n            (*pcVar6)();\n            (**0x40412c)();\n            *0x404122 = pcVar17;\n            pcVar6 = (*pcVar17)();\n            (*pcVar6)();\n            pcVar6 = (*pcVar17)();\n            *0x403fe4 = (*pcVar6)();\n            pcVar6 = (**0x404122)();\n            (*pcVar6)();\n            pcVar6 = (**0x404122)();\n            (*pcVar6)();\n            fcn.00401fea(0x40223a, 0x14);\n            pcVar6 = (*pcVar17)();\n            (*pcVar6)();\n            pcVar6 = (*pcVar17)();\n            (*pcVar6)();\n            pcVar6 = (*pcVar17)();\n            *0x401fbf = (*pcVar6)();\n            pcVar6 = (*pcVar17)();\n            *0x401fc3 = (*pcVar6)();\n            pcVar17 = (*pcVar17)();\n            (*pcVar17)();\n            pcVar17 = (**0x404122)();\n            iVar4 = *0x401fc3;\n            (*pcVar17)();\n            uStackY532 = 0x40199e;\n            iStackY536 = *0x401fc3;\n            fcn.004020d7(*0x401fc3, iVar4);\n            iStackY548 = *0x401fc3;\n            iVar4 = *0x401fc3 + *(*0x401fc3 + 0x3c);\n            uStackY552 = *(iVar4 + 0x34);\n            uStackY532 = 0x401da9;\n            uStackY540 = 0x4019f7;\n            *0x403fdc = (**0x404122)();\n            uStackY540 = 0;\n            uStackY544 = *(iVar4 + 0x54);\n            uStackY556 = *0x401f2a;\n            uStackY560 = 0x401a40;\n            (**0x403fdc)();\n            uVar1 = *(iVar4 + 0x14);\n            for (uVar18 = 0; uVar18 < *(iVar4 + 6); uVar18 = uVar18 + 1) {\n                iVar5 = uVar18 * 0x28 + iVar4 + 0x18 + uVar1;\n                iStackY572 = *(iVar5 + 0xc) + 0x400000;\n                iStackY568 = *0x401fc3 + *(iVar5 + 0x14);\n                uStackY560 = 0;\n                uStackY564 = *(iVar5 + 0x10);\n                uStackY576 = *0x401f2a;\n                uStackY580 = 0x401b12;\n                (**0x403fdc)();\n            }\n            *0x404340 = *(iVar4 + 0x34);\n            iStackY572 = *0x4042a4 + 8;\n            uStackY560 = 0;\n            uStackY564 = 4;\n            iStackY568 = 0x404340;\n            uStackY576 = *0x401f2a;\n            uStackY580 = 0x401b9f;\n            (**0x403fdc)();\n            uVar22 = 0xffbfffff < *(iVar4 + 0x28);\n            uVar15 = *(iVar4 + 0x28) + 0x400000;\n            uStackY580 = 0x401e1d;\n            uStackY584 = uStackY576;\n            uStackY588 = 0x401bd8;\n            *0x4042b0 = uVar15;\n            pcVar17 = (**0x404122)();\n            uStackY588 = 0x404200;\n            uStackY592 = *0x401f2e;\n            uStackY596 = 0x401bf8;\n            (*pcVar17)();\n            uStackY596 = 0x401dbc;\n            uStackY600 = *0x403fe4;\n            uStackY604 = 0x401c1c;\n            pcVar17 = (**0x404122)();\n            uStackY604 = *0x401f2a;\n            uStackY608 = 0x401c30;\n            (*pcVar17)();\n            uStackY608 = 0x401e41;\n            uStackY612 = uStackY604;\n            uStackY616 = 0x401c46;\n            pcVar17 = (**0x404122)();\n            uStackY616 = 0;\n            uVar23 = (*pcVar17)();\n            uVar16 = uVar23 >> 8;\n            uVar10 = uVar23 >> 0x20;\n            uVar13 = CONCAT11((uVar23 >> 0x28) - uVar16, uVar10);\n            cVar2 = extraout_ECX_00 | uVar18;\n            uVar7 = CONCAT11(uVar16, cVar2);\n            uVar12 = (extraout_ECX_00 | uVar18) & 0xffff0000 | uVar7;\n            iVar5 = ((CONCAT11((uVar13 >> 8) + uVar16 * '\\x02' | uVar16, uVar10) ^ uVar18) + 0x20b40c & 0x5d30) + 0x3b;\n            uVar15 = ((uVar15 & 0xffff0000 | CONCAT11(uVar15 >> 8 & extraout_ECX_00 >> 8, uVar15)) - uVar18) + 0x375e4;\n            uVar15 = ((uVar15 & 0xffff0000 | CONCAT11((uVar15 >> 8) * '\\x02', uVar15)) ^ &uStackY616) - 0x34b;\n            uVar19 = (uVar18 + uVar12 ^ 0x60f34a) - 0x5f;\n            uVar7 = (uVar23 & 0xffff0000ffff0000 | CONCAT11(uVar16 ^ uVar7 >> 8, uVar23)) &\n                    ((iVar4 - uVar18) - uVar22 & 0x6ec81 ^ ((uVar23 & 0xffff0000ffff0000) >> 0x20 | uVar13)) - uVar12;\n            uVar13 = CONCAT11((uVar15 >> 8) * '\\x02', uVar15);\n            uVar16 = uVar7 >> 8;\n            uVar18 = CONCAT11((iVar5 >> 8) + uVar16, iVar5);\n            cVar2 = cVar2 - uVar15;\n            uVar12 = uVar18 + 0x3832;\n            puVar8 = CONCAT11(-(uVar13 >> 8) - (0xffffc79f < uVar18 - 0x2e), cVar2) & 0xff75;\n            uVar18 = *puVar8;\n            *puVar8 = *puVar8 + 0x639001;\n            uVar15 = ((uVar15 & 0xffff0000 | uVar13) ^ uVar19 & 0x13ad92) - (0xff9c6ffe < uVar18);\n            uVar14 = uVar15 >> 8;\n            uVar18 = CONCAT11(uVar16 ^ uVar14, uVar7);\n            uVar16 = uVar18 >> 8;\n            uVar22 = puVar8 >> 8;\n            uVar9 = uVar22 + uVar16;\n            uVar15 = ((uVar15 & 0xffff0000 | CONCAT11(uVar14 + uVar16, uVar15)) - 0x8b98) - CARRY1(uVar22, uVar16);\n            uVar16 = (uVar15 >> 8) - uVar16;\n            uVar18 = (uVar7 & 0xffff0000 | uVar18) - uVar12;\n            uVar14 = uVar12 >> 8 | uVar9;\n            uVar22 = uVar18 >> 8;\n            uVar7 = uVar15 & 0xffff0000 | CONCAT11((uVar16 - uVar22) - (uVar14 < uVar16), uVar15);\n            uVar15 = ((uVar12 & 0xffff0000 | CONCAT11(uVar14 - uVar16, uVar12)) - 0xb29d) -\n                     (uVar16 < uVar22 || uVar16 - uVar22 < (uVar14 < uVar16));\n            uVar18 = uVar18 & 0xffff00ff;\n            uVar13 = ((uVar15 & 0xffff0000 | CONCAT11((uVar15 >> 8) + uVar22, uVar15)) & 0xbe1f0) + 0x2e;\n            uVar15 = uVar18 + uVar13;\n            uVar16 = uVar15 >> 8;\n            uVar22 = (CONCAT11(uVar9 * '\\x02', cVar2) & 0xff75) - uVar7 >> 8 ^ uVar13 >> 8 | uVar16 |\n                     ((uVar12 ^ 0xffff5c02) - uVar13) - CARRY4(uVar18, uVar13) >> 8;\n            iVar5 = ((uVar13 - (uVar7 - 0x298)) + -0x9a66) - (uVar16 < uVar22);\n            iVar4 = (uVar15 & 0xffff0000 | CONCAT11(uVar16 - uVar22, uVar15)) - 0x15f75e;\n            uVar13 = uVar19 & 0x130c02 ^ 0x9a66;\n            uVar15 = iVar5 + 0x17c3;\n            uVar16 = iVar4 >> 8;\n            uVar18 = CONCAT11((uVar15 >> 8) - uVar16, uVar15);\n            piVar21 = (0x37e - uVar13) - (iVar5 + 0x1912U < 0x14f) & 0x6ec81 ^ (uVar15 & 0xffff0000 | uVar18);\n            *piVar21 = *piVar21 + 0x46c3589;\n            return CONCAT44(((CONCAT11((uVar18 >> 8) + uVar16 * '\\x02' | uVar16, uVar15) ^ uVar13) + 0x20b40c & 0x5d30)\n                            + 0x3b, iVar4) & 0xffffffffffff00ff;\n        }\n    }\n    pcVar17 = *(*(iVar5 + 0x1c) + iVar4 + (*(*(iVar5 + 0x24) + iVar4 + iVar11 * 2) + 3) * 4) + iVar4;\n    goto code_r0x004013ff;\n}\n",
        "token_count": 3505
    },
    "004020d7": {
        "rules": [
            "validate payment card number using luhn algorithm with no lookup table/ca2c8d7b7d994625afebb42274522c55"
        ],
        "decompiled_code": "\nulong __cdecl fcn.004020d7(uint8_t *arg_8h, int32_t arg_ch)\n\n{\n    char cVar1;\n    char cVar2;\n    uint in_EAX;\n    uint32_t uVar3;\n    uint in_EDX;\n    uint32_t uVar4;\n    \n    uVar3 = 0;\n    uVar4 = 0;\n    do {\n        uVar4 = uVar4 + 1;\n        cVar1 = *(uVar4 + 0x40273e);\n        uVar3 = uVar3 + cVar1;\n        cVar2 = *(uVar3 + 0x40273e);\n        *(uVar4 + 0x40273e) = cVar2;\n        *(uVar3 + 0x40273e) = cVar1;\n        *arg_8h = *arg_8h ^ *((cVar2 + cVar1) + 0x40273e);\n        arg_8h = arg_8h + 1;\n        arg_ch = arg_ch + -1;\n    } while (arg_ch != 0);\n    return CONCAT44(in_EDX, in_EAX);\n}\n",
        "token_count": 259
    },
    "00402290": {
        "rules": [
            "validate payment card number using luhn algorithm with no lookup table/ca2c8d7b7d994625afebb42274522c55",
            "enumerate PE sections/e92b906b5db4485ea433dde72854611a"
        ],
        "decompiled_code": "\n// WARNING: Unable to track spacebase fully for stack\n\ncode * __fastcall fcn.00402290(int32_t *param_1)\n\n{\n    uint8_t *puVar1;\n    uint8_t uVar2;\n    int32_t iVar3;\n    code *pcVar4;\n    int32_t in_EAX;\n    int32_t iVar5;\n    int32_t *piVar6;\n    uint8_t uVar7;\n    uchar *puVar8;\n    uchar *puVar9;\n    uchar *puVar10;\n    uint32_t unaff_EBP;\n    int32_t aiStack8 [2];\n    \n    *(unaff_EBP + 0x56002444) = *(unaff_EBP + 0x56002444) + param_1 + CARRY4(*0x10, unaff_EBP);\n    iVar3 = *(&stack0x00000018 + unaff_EBP);\n    *param_1 = *param_1 + in_EAX;\n    *(&stack0xfffffffc + unaff_EBP) = iVar3;\n    puVar8 = &stack0xfffffff8 + unaff_EBP;\n    *(&stack0xfffffff8 + unaff_EBP) = 0x4022a5;\n    (*_sym.imp.USER32.dll_GetWindowRect)();\n    pcVar4 = *0x101306c;\n    *(puVar8 + -4) = 1;\n    *(puVar8 + -8) = *(puVar8 + 0x14);\n    *(puVar8 + -0xc) = *(puVar8 + 0x10);\n    *(puVar8 + -0x10) = 1;\n    puVar9 = puVar8 + -0x14;\n    *(puVar8 + -0x14) = 0x4022bb;\n    iVar5 = (**0x101306c)();\n    *(puVar9 + -4) = (iVar5 / 2 - *(puVar9 + 0x20)) + *(puVar9 + 0x18);\n    *(puVar9 + -8) = 0;\n    puVar10 = puVar9 + -0xc;\n    *(puVar9 + -0xc) = 0x4022d1;\n    (*pcVar4)();\n    piVar6 = (*(puVar10 + 0x20) - *(puVar10 + 0x18)) / 2;\n    iVar5 = *piVar6;\n    puVar1 = iVar3 + -1;\n    uVar2 = *puVar1;\n    uVar7 = *(puVar10 + 0x20) - *(puVar10 + 0x18) >> 0x1f;\n    *puVar1 = *puVar1 + uVar7;\n    return sym.imp.USER32.dll_MoveWindow + piVar6 + (CARRY1(uVar2, uVar7) - iVar5);\n}\n",
        "token_count": 637
    }
}