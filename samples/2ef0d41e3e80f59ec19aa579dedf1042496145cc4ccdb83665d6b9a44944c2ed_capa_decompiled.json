{
    "00414565": {
        "rules": [
            "validate payment card number using luhn algorithm with no lookup table/ca2c8d7b7d994625afebb42274522c55"
        ],
        "decompiled_code": "\n// WARNING: Control flow encountered bad instruction data\n// WARNING: Instruction at (ram,0x0041457b) overlaps instruction at (ram,0x0041457a)\n// \n// WARNING: Removing unreachable block (ram,0x00414612)\n// WARNING: Removing unreachable block (ram,0x00414605)\n// WARNING: Removing unreachable block (ram,0x0041461f)\n\nuint16_t * __fastcall fcn.00414565(int32_t *param_1, uint32_t *param_2, uint32_t param_3)\n\n{\n    uchar *puVar1;\n    uchar uVar2;\n    uint32_t uVar3;\n    code *pcVar4;\n    char cVar5;\n    uint16_t uVar6;\n    uint16_t *puVar7;\n    uint16_t *in_EAX;\n    uint8_t *puVar8;\n    int32_t *piVar9;\n    ushort uVar11;\n    uint8_t uVar12;\n    uint8_t uVar13;\n    uint32_t *unaff_EBX;\n    uint32_t *unaff_EBP;\n    uint32_t *puVar14;\n    uint32_t *puVar15;\n    uint32_t *puVar16;\n    uint *puVar17;\n    uint32_t *unaff_ESI;\n    uint32_t *puVar18;\n    uint32_t *unaff_EDI;\n    uint32_t *puVar19;\n    ushort in_ES;\n    int32_t in_GS_OFFSET;\n    uchar in_CF;\n    bool bVar20;\n    uchar in_ZF;\n    uint32_t *unaff_retaddr;\n    char acStack132 [96];\n    uint *puStack36;\n    uint32_t *puStack32;\n    uint32_t *puStack28;\n    uchar *puStack24;\n    uint32_t *puStack20;\n    uint32_t *puStack16;\n    uchar auStack8 [4];\n    uint uStack4;\n    uint8_t uVar10;\n    \ncode_r0x00414565:\n    puStack28 = &uStack4;\n    puVar14 = &uStack4;\n    puVar15 = &uStack4;\n    puVar16 = &uStack4;\n    uStack4 = unaff_EBP;\n    uVar11 = SUB42(param_2, 0);\n    puVar18 = unaff_ESI;\n    if (in_CF) {\n        uVar10 = in_EAX;\n        *in_EAX = *in_EAX + uVar10;\n        bVar20 = CARRY1(*in_EAX, uVar10);\n        *in_EAX = *in_EAX + uVar10;\n        puVar19 = unaff_EDI + 1;\n        if (puVar19 == NULL) {\n            bVar20 = (param_3 & 1) != 0;\n            pe_dos_header = *unaff_ESI;\ncode_r0x0041454b:\n            puStack16 = 0xa49d2f0f;\n            *param_1 = *param_1 + 0x1a + bVar20;\n            pcVar4 = swi(1);\n            puVar7 = (*pcVar4)();\n            return puVar7;\n        }\n        if (bVar20) goto code_r0x00414572;\n        piVar9 = param_1 + 0x19;\n        *piVar9 = *piVar9 + bVar20 * ((in_EAX & 3) - (*piVar9 & 3));\n        if (!bVar20) {\n            puVar15 = &uStack4;\n            if (!bVar20) goto code_r0x0041457b;\n            *in_EAX = *in_EAX + uVar10;\n            *in_EAX = *in_EAX + uVar10;\n            *in_EAX = *in_EAX + uVar10;\n            uStack4 = unaff_ESI;\n            uVar3 = param_2[0x1d];\n            puVar17 = uVar3 * 0x416c6175;\n            uVar2 = in(uVar11);\n            *puVar19 = uVar2;\n            puVar15 = unaff_EDI + 3;\n            uVar2 = in(uVar11);\n            *(unaff_EDI + 2) = uVar2;\n            unaff_ESI = puVar17 + 1;\n            out(*puVar17, uVar11);\n            *in_EAX = *in_EAX + (puVar17 != uVar3 * 0x416c6175) * ((in_EAX & 3) - (*in_EAX & 3));\n            *in_EAX = *in_EAX + uVar10;\n            puVar8 = puVar17 + 0x6d;\n            bVar20 = CARRY1(*puVar8, param_2);\n            *puVar8 = *puVar8 + param_2;\n            if (bVar20) {\n                return in_EAX;\n            }\n            if (*puVar8 != 0) {\n                unaff_EBX = unaff_EBX << (param_1 & 0x1f);\n                goto code_r0x00414588;\n            }\n            unaff_EDI = unaff_EDI + 1;\n            uVar2 = in(uVar11);\n            *puVar15 = uVar2;\n            unaff_ESI = puVar17 + 5;\n            goto code_r0x00414526;\n        }\n        in_EAX = in_EAX ^ 0x3c;\n        puVar14 = &uStack4 + 1;\n    }\n    else {\n        puVar19 = unaff_EDI;\n        if (!in_ZF) {\n            uVar10 = in(uVar11);\n            in_EAX = in_EAX & 0xffffff00 | uVar10;\n            goto code_r0x004145a1;\n        }\n    }\n    *param_1 = *param_1 | unaff_EBX >> 8;\n    in_EAX = in_EAX + -1;\n    puVar15 = puVar14;\ncode_r0x00414572:\n    do {\n        unaff_EDI = puVar19;\n        in_EAX = in_EAX & 0xffffff00 | in_EAX | unaff_EBX >> 8;\n        uVar10 = *unaff_EBX;\n        uVar12 = param_2 >> 8;\n        *unaff_EBX = *unaff_EBX + uVar12;\n        puVar8 = param_2 + 0x53;\n        uVar13 = param_1 & 7;\n        *puVar8 = *puVar8 << uVar13 | *puVar8 >> 8 - uVar13;\n        bVar20 = (param_1 & 0x1f) != 0;\n        bVar20 = !bVar20 & CARRY1(uVar10, uVar12) | (bVar20 && (*puVar8 & 1) != 0);\n        in_ES = SUB42(unaff_retaddr, 0);\n        unaff_ESI = *(in_EAX + 6);\n        uStack4 = unaff_EDI;\n        param_1 = param_1 + 1;\n        puStack28 = puVar15;\n        puVar16 = puVar15;\n        puVar15 = unaff_EDI;\n        unaff_retaddr = puVar18;\n        if (param_1 == NULL) {\ncode_r0x00414526:\n            if (!bVar20) break;\n        }\n        else {\ncode_r0x00414588:\n            puVar7 = in_EAX + puVar15 * 4;\n            *puVar7 = *puVar7 ^ in_EAX;\n            puStack28 = puVar16;\n            unaff_EDI = puVar15;\n            if (-1 < *puVar7) {\n                *(param_1 + unaff_EBX & 0xffffff00 | param_1 + unaff_EBX | *(puVar16 + -0x12b09d71)) = in_EAX;\n    // WARNING: Bad instruction - Truncating control flow here\n                halt_baddata();\n            }\n        }\n        do {\n            puStack28[-0xb] = in_EAX;\n            puVar8 = param_1 + in_EAX;\n            in_EAX = 0xf868a6c3;\n            param_1 = puVar8 + -1;\n            if (param_1 != NULL && puVar8 != NULL) {\n                while( true ) {\n                    puVar8 = in_EAX + param_1;\n                    bVar20 = puVar8 == NULL;\n                    piVar9 = param_1 + -1;\n                    if (piVar9 == NULL) {\n                        param_2 = param_2 | unaff_ESI;\n                        auStack8 = *(unaff_EDI + &uStack4);\n                        piVar9 = -*(param_1 + 99);\n                        bVar20 = -*(param_1 + 99) == 0;\n                        LOCK();\n                    }\n                    if (bVar20) break;\n                    unaff_ESI = *(puStack28 + 0x7e);\n                    auStack8 = puVar8;\n                    puStack16 = param_2;\n                    puStack20 = unaff_EBX;\n                    puStack24 = &uStack4;\n                    puStack32 = unaff_ESI;\n                    puStack36 = unaff_EDI + &uStack4;\n                    uStack4 = puStack28;\n                    in_EAX = puVar8 | 0xf;\n                    param_2 = param_2 & 0xffff0000 | CONCAT11(0x36, param_2);\n                    param_1 = piVar9;\n                }\n                acStack132[unaff_EDI] = (acStack132[unaff_EDI] - (param_2 >> 8)) - (*(puStack28 + 0x3b) < piVar9);\n                return NULL;\n            }\n            unaff_EBX = unaff_EBX + -1;\n            unaff_EDI = auStack8 + 3 + unaff_EDI;\n            uStack4 = CONCAT22(uStack4._2_2_, in_ES);\n        } while (unaff_EDI != NULL);\ncode_r0x004145a1:\n        in_EAX = in_EAX + -0x1cf1bf65;\n        puVar19 = unaff_EDI | *unaff_ESI;\n        uVar13 = param_2 >> 8;\n        uVar10 = uVar13 >> 1;\n        uVar13 = uVar13 << 7;\n        param_2 = param_2 & 0xffff0000 | CONCAT11(uVar10 | uVar13, param_2);\n        puVar15 = unaff_retaddr;\n        if ((((uVar10 & 0x40) != 0) != (uVar13 != 0)) != puVar19 < 0) {\n    // WARNING: Bad instruction - Truncating control flow here\n            halt_baddata();\n        }\ncode_r0x0041457b:\n        param_2 = param_2 + 1;\n        puVar18 = unaff_ESI;\n        unaff_retaddr = unaff_EBX;\n    } while( true );\n    cVar5 = in_EAX;\n    *(in_GS_OFFSET + in_EAX) = *(in_GS_OFFSET + in_EAX) + cVar5;\n    *(unaff_EDI + 0x13) = *(unaff_EDI + 0x13) + param_1;\n    unaff_EBP = puStack28 + 1;\n    unaff_ESI = unaff_ESI ^ *param_2;\n    puVar1 = unaff_EDI + 1;\n    uVar2 = in(param_2);\n    *unaff_EDI = uVar2;\n    unaff_EDI = unaff_EDI + 2;\n    uVar2 = in(param_2);\n    *puVar1 = uVar2;\n    *(in_EAX + 0x2f000080) = *(in_EAX + 0x2f000080) + cVar5;\n    *in_EAX = *in_EAX + cVar5;\n    *0x7f808ed9 = cVar5 + *in_EAX;\n    uVar6 = in_EAX & 0xff00 | *0x7f808ed9;\n    uVar10 = param_1 + 1 >> 8;\n    bVar20 = CARRY1(*param_2, uVar10);\n    *param_2 = *param_2 + uVar10;\n    if (param_1 == NULL || *param_2 == 0) goto code_r0x0041454b;\n    uVar3 = uVar6 / *param_1 & 0xffU | uVar6 % *param_1 << 8;\n    param_1 = (param_1 & 0xffffff00 | param_1 | uVar3 >> 8) + unaff_EBP;\n    unaff_EBX = (unaff_EBX >> 8 & 0xffff00 | unaff_EBX >> 8 ^ param_2 >> 8) << 8;\n    in_ES = SUB42(*0x10, 0);\n    in_CF = false;\n    uVar10 = param_2 | *(puStack28 + -0x1d);\n    param_2 = param_2 & 0xffffff00 | uVar10;\n    in_ZF = uVar10 == 0;\n    uVar10 = in(param_2);\n    in_EAX = (in_EAX & 0xffff0000 | uVar3) - 1 & 0xffffff00 | uVar10;\n    unaff_retaddr = unaff_EBP;\n    goto code_r0x00414565;\n}\n",
        "token_count": 3025
    }
}