{
    "null": {
        "rules": [
            "decompress data using aPLib/06666ba0b6a14a5481e4ee6eb664d454"
        ],
        "decompiled_code": "\n// WARNING: Instruction at (ram,0x0048c8b5) overlaps instruction at (ram,0x0048c8b4)\n// \n\nvoid __cdecl\nentry0(uint noname_0, uint noname_1, uint noname_2, uint noname_3, uint noname_4, uint noname_5, uint noname_6, \n      uint noname_7, uint noname_8, uint noname_9, uint noname_10, uint noname_11, uint noname_12, uint noname_13, \n      uint noname_14, uint noname_15, uint noname_16, uint noname_17, uint noname_18, uint noname_19, uint noname_20, \n      uint noname_21, uint noname_22, uint arg_64h)\n\n{\n    char cVar1;\n    uint8_t uVar2;\n    uchar uVar3;\n    int32_t iVar4;\n    code *pcVar5;\n    uint8_t *puVar6;\n    int32_t iVar7;\n    uint32_t uVar8;\n    uint uVar9;\n    char extraout_CL;\n    uchar *puVar10;\n    uchar *extraout_ECX;\n    int32_t *piVar11;\n    int32_t iVar12;\n    int32_t extraout_EDX;\n    uint *puVar13;\n    uint32_t uVar14;\n    uint32_t uVar15;\n    int32_t *piVar16;\n    uchar *puVar17;\n    uint32_t uVar18;\n    uint32_t *puVar19;\n    uint *puVar20;\n    int32_t *piVar21;\n    int32_t *piVar22;\n    int32_t *piVar23;\n    int32_t in_FS_OFFSET;\n    bool bVar24;\n    bool bVar25;\n    char cVar26;\n    uchar auStack256 [96];\n    uchar auStack160 [88];\n    uint uStack72;\n    int32_t iStack68;\n    int32_t *piStack64;\n    int32_t iStack60;\n    uchar *puStack56;\n    int32_t iStack52;\n    uint8_t *puStack48;\n    int32_t iStack44;\n    uchar *puStack40;\n    int32_t *piStack36;\n    \n    puVar19 = 0x477000;\n    puVar20 = 0x401000;\n    *0x48e7b8 = 0x13708d60;\n    uVar18 = 0xffffffff;\ncode_r0x004b2c6a:\n    uVar14 = *puVar19;\n    bVar24 = puVar19 < 0xfffffffc;\n    puVar19 = puVar19 + 1;\n    bVar25 = CARRY4(uVar14, uVar14) || CARRY4(uVar14 * 2, bVar24);\n    uVar14 = uVar14 * 2 + bVar24;\ncode_r0x004b2c71:\n    if (!bVar25) {\n        iVar7 = 1;\n        do {\n            bVar24 = CARRY4(uVar14, uVar14);\n            uVar15 = uVar14 * 2;\n            if (uVar15 == 0) {\n                uVar14 = *puVar19;\n                bVar25 = puVar19 < 0xfffffffc;\n                puVar19 = puVar19 + 1;\n                bVar24 = CARRY4(uVar14, uVar14) || CARRY4(uVar14 * 2, bVar25);\n                uVar15 = uVar14 * 2 + bVar25;\n            }\n            uVar8 = iVar7 * 2 + bVar24;\n            uVar14 = uVar15 * 2;\n            if (CARRY4(uVar15, uVar15)) {\n                if (uVar14 != 0) goto code_r0x004b2cb3;\n                uVar15 = *puVar19;\n                bVar24 = puVar19 < 0xfffffffc;\n                puVar19 = puVar19 + 1;\n                uVar14 = uVar15 * 2 + bVar24;\n                if (CARRY4(uVar15, uVar15) || CARRY4(uVar15 * 2, bVar24)) goto code_r0x004b2cb3;\n            }\n            bVar24 = CARRY4(uVar14, uVar14);\n            uVar14 = uVar14 * 2;\n            if (uVar14 == 0) {\n                uVar14 = *puVar19;\n                bVar25 = puVar19 < 0xfffffffc;\n                puVar19 = puVar19 + 1;\n                bVar24 = CARRY4(uVar14, uVar14) || CARRY4(uVar14 * 2, bVar25);\n                uVar14 = uVar14 * 2 + bVar25;\n            }\n            iVar7 = (uVar8 - 1) * 2 + bVar24;\n        } while( true );\n    }\n    uVar3 = *puVar19;\n    puVar19 = puVar19 + 1;\n    *puVar20 = uVar3;\n    puVar20 = puVar20 + 1;\n    goto code_r0x004b2c66;\ncode_r0x004b2cb3:\n    iVar7 = 0;\n    if (uVar8 < 3) {\n        bVar24 = CARRY4(uVar14, uVar14);\n        uVar14 = uVar14 * 2;\n        if (uVar14 == 0) {\n            uVar14 = *puVar19;\n            bVar25 = puVar19 < 0xfffffffc;\n            puVar19 = puVar19 + 1;\n            bVar24 = CARRY4(uVar14, uVar14) || CARRY4(uVar14 * 2, bVar25);\n            uVar14 = uVar14 * 2 + bVar25;\n        }\n    }\n    else {\n        uVar3 = *puVar19;\n        puVar19 = puVar19 + 1;\n        uVar18 = CONCAT31(uVar8 + -3, uVar3) ^ 0xffffffff;\n        if (uVar18 == 0) {\n            puVar19 = 0x401000;\n            iVar7 = 0x4bfb;\n            goto code_r0x004b2d42;\n        }\n        bVar24 = (uVar18 & 1) != 0;\n        uVar18 = uVar18 >> 1;\n    }\n    if (!bVar24) {\n        iVar7 = 1;\n        bVar24 = CARRY4(uVar14, uVar14);\n        uVar14 = uVar14 * 2;\n        if (uVar14 == 0) {\n            uVar14 = *puVar19;\n            bVar25 = puVar19 < 0xfffffffc;\n            puVar19 = puVar19 + 1;\n            bVar24 = CARRY4(uVar14, uVar14) || CARRY4(uVar14 * 2, bVar25);\n            uVar14 = uVar14 * 2 + bVar25;\n        }\n        if (!bVar24) {\n            do {\n                do {\n                    bVar24 = CARRY4(uVar14, uVar14);\n                    uVar15 = uVar14 * 2;\n                    if (uVar15 == 0) {\n                        uVar14 = *puVar19;\n                        bVar25 = puVar19 < 0xfffffffc;\n                        puVar19 = puVar19 + 1;\n                        bVar24 = CARRY4(uVar14, uVar14) || CARRY4(uVar14 * 2, bVar25);\n                        uVar15 = uVar14 * 2 + bVar25;\n                    }\n                    iVar7 = iVar7 * 2 + bVar24;\n                    uVar14 = uVar15 * 2;\n                } while (!CARRY4(uVar15, uVar15));\n                if (uVar14 != 0) break;\n                uVar15 = *puVar19;\n                bVar24 = puVar19 < 0xfffffffc;\n                puVar19 = puVar19 + 1;\n                uVar14 = uVar15 * 2 + bVar24;\n            } while (!CARRY4(uVar15, uVar15) && !CARRY4(uVar15 * 2, bVar24));\n            iVar7 = iVar7 + 2;\n            goto code_r0x004b2d05;\n        }\n    }\n    bVar24 = CARRY4(uVar14, uVar14);\n    uVar14 = uVar14 * 2;\n    if (uVar14 == 0) {\n        uVar14 = *puVar19;\n        bVar25 = puVar19 < 0xfffffffc;\n        puVar19 = puVar19 + 1;\n        bVar24 = CARRY4(uVar14, uVar14) || CARRY4(uVar14 * 2, bVar25);\n        uVar14 = uVar14 * 2 + bVar25;\n    }\n    iVar7 = iVar7 * 2 + bVar24;\ncode_r0x004b2d05:\n    uVar15 = iVar7 + 2 + (uVar18 < 0xfffffb00);\n    puVar13 = puVar20 + uVar18;\n    if (uVar18 < 0xfffffffd) {\n        do {\n            uVar9 = *puVar13;\n            puVar13 = puVar13 + 1;\n            *puVar20 = uVar9;\n            puVar20 = puVar20 + 1;\n            bVar24 = 3 < uVar15;\n            uVar15 = uVar15 - 4;\n        } while (bVar24 && uVar15 != 0);\n        puVar20 = puVar20 + uVar15;\n    }\n    else {\n        do {\n            uVar3 = *puVar13;\n            puVar13 = puVar13 + 1;\n            *puVar20 = uVar3;\n            puVar20 = puVar20 + 1;\n            uVar15 = uVar15 - 1;\n        } while (uVar15 != 0);\n    }\ncode_r0x004b2c66:\n    bVar25 = CARRY4(uVar14, uVar14);\n    uVar14 = uVar14 * 2;\n    if (uVar14 == 0) goto code_r0x004b2c6a;\n    goto code_r0x004b2c71;\n    do {\n        for (; (1 < cVar26 + 0x18U || (*puVar19 != '$')); puVar19 = puVar19 + 1) {\ncode_r0x004b2d42:\n            cVar26 = *puVar19;\n        }\n        uVar18 = *puVar19;\n        cVar26 = *(puVar19 + 1);\n        *puVar19 = (((CONCAT21(uVar18 >> 8, uVar18 >> 0x10) & 0xffff) << 8 | uVar18 >> 0x18) - puVar19) + 0x401000;\n        puVar19 = puVar19 + 5;\n        iVar7 = iVar7 + -1;\n    } while (iVar7 != 0);\n    piVar21 = 0x4af000;\n    while (piStack36 = *piVar21,  piStack36 != NULL) {\n        piStack36 = piStack36 + 0x4b6664;\n        piVar16 = piVar21[1] + 0x401000;\n        piVar23 = piVar21 + 2;\n        puStack40 = 0x4b2d90;\n        uVar9 = (*_sym.imp.KERNEL32.DLL_LoadLibraryA)();\n        while( true ) {\n            cVar26 = *piVar23;\n            piVar21 = piVar23 + 1;\n            if (cVar26 == '\\0') break;\n            piVar11 = piVar21;\n            piVar22 = piVar21;\n            do {\n                piVar23 = piVar22;\n                if (piVar11 == NULL) break;\n                piVar11 = piVar11 + -1;\n                piVar23 = piVar22 + 1;\n                cVar1 = *piVar22;\n                piVar22 = piVar23;\n            } while (cVar26 + -1 != cVar1);\n            iStack44 = 0x4b2da5;\n            puStack40 = uVar9;\n            piStack36 = piVar21;\n            iVar7 = (*_sym.imp.KERNEL32.DLL_GetProcAddress)();\n            if (iVar7 == 0) {\n                piStack36 = 0x4b2db6;\n                piStack36 = (*_sym.imp.KERNEL32.DLL_ExitProcess)();\n                goto code_r0x004b2db6;\n            }\n            *piVar16 = iVar7;\n            piVar16 = piVar16 + 1;\n        }\n    }\ncode_r0x004b2db6:\n    pcVar5 = _sym.imp.KERNEL32.DLL_VirtualProtect;\n    iStack68 = 0x400000;\n    puStack40 = &stack0xffffffdc;\n    iStack44 = 4;\n    puStack48 = 0x1000;\n    puStack56 = 0x4b2dcf;\n    iStack52 = iStack68;\n    (*_sym.imp.KERNEL32.DLL_VirtualProtect)();\n    *0x40021f = *0x40021f & 0x7f;\n    *0x400247 = *0x400247 & 0x7f;\n    iStack60 = iStack52;\n    piStack64 = 0x1000;\n    uStack72 = 0x4b2de4;\n    puStack56 = &stack0xffffffcc;\n    (*pcVar5)();\n    iVar7 = iStack60;\n    do {\n    } while (&stack0xffffffe0 != &stack0xffffff60);\n    *piStack64 = (*piStack64 - puStack56) - (&stack0xffffffe0 < 0xffffff80);\n    puVar10 = puStack40 + -1;\n    piVar21 = piStack64;\n    if (puVar10 != NULL && *piStack64 == 0) {\n        puVar6 = puStack48 & 0xffff00ff;\n        cVar26 = &stack0xffffff60;\n        bVar24 = SCARRY1(cVar26, -0x4a);\n        puVar19 = &stack0xffffff00 | cVar26 + 0xb6;\n        iVar12 = -0x43d9afb2;\n        puVar6[0x4185a123] = 0;\n        cVar26 = puVar6[0x4185a123] == 0;\n        puVar17 = puStack56;\n        goto code_r0x0048c8aa;\n    }\n    uVar18 = &stack0xb477a900 & 0xffff00ff | &stack0xb477a969 + (&stack0xb477a969 >> 8) * -0x2e;\n    iVar12 = iStack44 + 1;\n    uVar18 = uVar18 & *(in_FS_OFFSET + uVar18) ^ 0x50;\n    puVar6 = puStack48;\n    puVar17 = puStack56;\n    while( true ) {\n        puVar19 = uVar18 & 0xffffff00 | uVar18 + 0x7a;\n        iVar4 = *(puVar17 + 100);\n        *(puVar19 + 0x13aead81) = *(puVar19 + 0x13aead81) + iVar12;\n        bVar24 = false;\n        cVar26 = (*(puVar10 + -0x4b) & puVar19) == 0;\n        puVar17 = 0xb7bb48a5;\n        piVar21 = piVar21 + (0x85 < uVar18) + iVar4;\ncode_r0x0048c8aa:\n        if (puVar10 + -1 != NULL && cVar26 != false) break;\n        uVar18 = CONCAT44(iVar12, puVar19) / *puVar19;\n        iVar12 = CONCAT44(iVar12, puVar19) % *puVar19;\n        LOCK();\n        puVar10 = puVar10 + -2;\n        if (puVar10 == NULL || cVar26 != false) {\n            pcVar5 = swi(4);\n            if (bVar24 == true) {\n                uVar18 = (*pcVar5)();\n                puVar10 = extraout_ECX;\n            }\n            if (puVar10 != 0x1 && cVar26 == '\\0') {\n                return;\n            }\n            *(iVar7 + 5) = uVar18;\n            func_0xa250bf49();\n            *piVar21 = *piVar21 + extraout_CL;\n            iVar12 = extraout_EDX;\ncode_r0x0048c8c5:\n            uVar2 = *puVar6;\n            *puVar6 = *puVar6 >> 4;\n            puVar19 = puVar17 + 6;\n            uVar14 = (uVar2 >> 3 & 1) != 0;\n            puVar10 = *puVar19;\n            uVar18 = *puVar19;\n            *puVar19 = (uVar18 - puVar17) - uVar14;\n            uVar18 = puVar6 & 0xffffff00 | (puVar6 + -0x17) - (puVar10 < puVar17 || uVar18 - puVar17 < uVar14);\n            out(iVar12, uVar18);\n            out(iVar12, uVar18);\n            do {\n    // WARNING: Do nothing block with infinite loop\n            } while( true );\n        }\n    }\n    puVar6 = puVar19 + 0x148522e >> (puVar10 + -1 & 0x1f);\n    goto code_r0x0048c8c5;\n}\n",
        "token_count": 4009
    },
    "00477c2e": {
        "rules": [
            "validate payment card number using luhn algorithm with no lookup table/ca2c8d7b7d994625afebb42274522c55"
        ],
        "decompiled_code": "\n// WARNING: Control flow encountered bad instruction data\n// WARNING: Instruction at (ram,0x00477c8f) overlaps instruction at (ram,0x00477c8e)\n// \n// WARNING: Removing unreachable block (ram,0x00477c5a)\n// WARNING: Type propagation algorithm not settling\n\nuint32_t * __fastcall fcn.00477c2e(int32_t *param_1, int32_t *param_2)\n\n{\n    char **ppcVar1;\n    uint32_t *puVar2;\n    uint16_t *puVar3;\n    uint8_t *puVar4;\n    uint32_t **ppuVar5;\n    uint *puVar6;\n    uint32_t uVar7;\n    uint8_t uVar8;\n    uint8_t uVar9;\n    uint32_t *in_EAX;\n    char *pcVar10;\n    uint32_t unaff_EBX;\n    uchar *puVar11;\n    uint32_t **unaff_ESI;\n    uint32_t **ppuVar12;\n    int32_t unaff_EDI;\n    int32_t iVar13;\n    ushort in_SS;\n    uint16_t in_DS;\n    uint8_t in_CF;\n    bool bVar14;\n    uint8_t in_AF;\n    uint32_t uStack16;\n    uchar auStack12 [4];\n    \n    do {\n        puVar11 = &stack0xfffffffc;\n        ppuVar5 = unaff_ESI + 1;\n        out(*unaff_ESI, param_2);\n        *(unaff_EDI + 0x5d) = *(unaff_EDI + 0x5d);\n        puVar3 = unaff_EBX + 0x8ae2b755;\n        *puVar3 = *puVar3 + (in_CF & 1) * ((param_1 & 3) - (*puVar3 & 3));\n        in_EAX = in_EAX | 0xd8e452ea;\n        uVar9 = in_EAX;\n        if (param_1 < param_2) {\n            if (param_1 < param_2) {\n                *in_EAX = *in_EAX + uVar9;\n                *(unaff_EBX + 0xaba4ed35) = auStack12 + *(unaff_EBX + 0xaba4ed35);\n                *unaff_EDI = param_1 != 0xffffffff;\n                *0x787bd0c4 = param_2;\n    // WARNING: Bad instruction - Truncating control flow here\n                halt_baddata();\n            }\n            bVar14 = unaff_EBX < *in_EAX;\n            ppuVar12 = ppuVar5;\n            if (unaff_EBX == *in_EAX) {\n                puVar11 = &stack0xfffffffb;\n                *(unaff_EDI + 0x13) = 0x4c;\n                param_2 = unaff_EDI + 1;\n                uVar9 = *ppuVar5 & 0x15;\n                bVar14 = uVar9 < 0x75;\n                pcVar10 = param_1 + -1;\n                if (pcVar10 == NULL || uVar9 == 0x75) {\n                    bVar14 = 0x1b < &uStack16;\n                }\n                param_1 = pcVar10 & 0xffff0000 | CONCAT11(0x31, pcVar10);\n                ppuVar12 = unaff_ESI + 2;\n                in_EAX = *ppuVar5;\n            }\n            *param_2 = (*param_2 - (in_EAX >> 8)) - bVar14;\n            *(puVar11 + -0x10) = in_EAX;\n            *0xb9db4a5b = SUB41(in_EAX, 0);\n            param_1 = param_1 + -1;\n            if (param_1 == NULL) {\n                iVar13 = unaff_EDI + -1;\n                while( true ) {\n                    *ppuVar12 = 0;\n                    in(2);\n                    iVar13 = iVar13 + 5;\n                    if (iVar13 == 0) break;\n                    in(0x4f);\n                }\n                pe_dos_header = 0x0;\n    // WARNING: Bad instruction - Truncating control flow here\n                halt_baddata();\n            }\ncode_r0x00477c9f:\n            if (param_1 == 0x1) {\n    // WARNING: Bad instruction - Truncating control flow here\n                halt_baddata();\n            }\n            return in_EAX;\n        }\n        puVar4 = unaff_EDI + -0x547cbc50;\n        in_CF = 0;\n        *puVar4 = *puVar4 | uVar9;\n        if (*puVar4 < '\\x01') {\n            uVar8 = uVar9 + 0x72;\n            uVar7 = in_EAX & 0xffffff00;\n            in_EAX = uVar7 | uVar8;\n            uStack16 = uStack16 & 0xffff0000 | in_DS;\n            *(param_1 + -0x87c2e2) = *(param_1 + -0x87c2e2) + uVar8 + (0x8d < uVar9);\n            *param_2 = -*param_2;\n            if (*param_2 == 0) {\n                bVar14 = false;\n                uVar9 = POPCOUNT(*(in_EAX + -2) & 0xf6);\n                if ((*(in_EAX + -2) & 0xf6) != 0) {\n                    ppcVar1 = unaff_EBX - 0x18;\n                    pcVar10 = *ppcVar1;\n                    *ppcVar1 = *ppcVar1 + param_2;\n                    uVar9 = 9 < (uVar8 & 0xf) | in_AF;\n                    uVar8 = uVar8 + uVar9 * -6;\n                    in_EAX = uVar7 | uVar8 + (0x9f < uVar8 | CARRY4(pcVar10, param_2) | uVar9 * (uVar8 < 6)) * -0x60;\n                    goto code_r0x00477c9f;\n                }\n                in_EAX = CONCAT31(uVar7 >> 8, 1);\n            }\n            else {\n                puVar2 = unaff_EBX + 0x5d;\n                bVar14 = CARRY4(*puVar2, unaff_EBX);\n                *puVar2 = *puVar2 + unaff_EBX;\n                uVar9 = POPCOUNT(*puVar2 & 0xff);\n                uStack16 = unaff_EBX;\n            }\n            if ((uVar9 & 1) != 0) {\n                param_2[-4] = param_1;\n                return in_EAX & 0xffffff00 | in_EAX + *(uStack16 + 0xe35f6fbf) + bVar14;\n            }\n            out(*ppuVar5, param_2);\n            goto code_r0x00477c9f;\n        }\n        puVar6 = segment(in_SS, *0x10 + -0xc);\n        *puVar6 = 0x75706876;\n        unaff_ESI = ppuVar5;\n    } while( true );\n}\n",
        "token_count": 1621
    }
}